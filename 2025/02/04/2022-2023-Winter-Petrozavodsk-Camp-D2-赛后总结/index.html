<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2022-2023 Winter Petrozavodsk Camp D2 赛后总结 | Oldplace</title><meta name="author" content="player"><meta name="copyright" content="player"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="https:&#x2F;&#x2F;codeforces.com&#x2F;gym&#x2F;104427 A不是很难，显然的事情，如果终止状态两个相邻的块颜色相同，那么开始的时候他们也是这个颜色。 而其余块的颜色显然是随意的，因为联通块的边界都已经被定死了，中间的不一样大不了操作一下就行了。 时间复杂度：$O(nm)$ 1234567891011121314151617181920212223242526272829303132#in">
<meta property="og:type" content="article">
<meta property="og:title" content="2022-2023 Winter Petrozavodsk Camp D2 赛后总结">
<meta property="og:url" content="http://oldplace.github.io/2025/02/04/2022-2023-Winter-Petrozavodsk-Camp-D2-%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Oldplace">
<meta property="og:description" content="https:&#x2F;&#x2F;codeforces.com&#x2F;gym&#x2F;104427 A不是很难，显然的事情，如果终止状态两个相邻的块颜色相同，那么开始的时候他们也是这个颜色。 而其余块的颜色显然是随意的，因为联通块的边界都已经被定死了，中间的不一样大不了操作一下就行了。 时间复杂度：$O(nm)$ 1234567891011121314151617181920212223242526272829303132#in">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://oldplace.github.io/img/my%20avatar.jpg">
<meta property="article:published_time" content="2025-02-04T11:57:40.000Z">
<meta property="article:modified_time" content="2025-02-04T11:59:50.292Z">
<meta property="article:author" content="player">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://oldplace.github.io/img/my%20avatar.jpg"><link rel="shortcut icon" href="/img/author16.png"><link rel="canonical" href="http://oldplace.github.io/2025/02/04/2022-2023-Winter-Petrozavodsk-Camp-D2-%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2022-2023 Winter Petrozavodsk Camp D2 赛后总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2025-02-04 19:59:50'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4233465_4sh0n7ckry.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/my%20avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">159</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">70</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Oldplace"><span class="site-name">Oldplace</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">2022-2023 Winter Petrozavodsk Camp D2 赛后总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-02-04T11:57:40.000Z" title="发表于 2025-02-04 19:57:40">2025-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-04T11:59:50.292Z" title="更新于 2025-02-04 19:59:50">2025-02-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BF%A1%E6%81%AF%E5%AD%A6/">信息学</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>26分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2022-2023 Winter Petrozavodsk Camp D2 赛后总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://codeforces.com/gym/104427">https://codeforces.com/gym/104427</a></p>
<h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><p>不是很难，显然的事情，如果终止状态两个相邻的块颜色相同，那么开始的时候他们也是这个颜色。</p>
<p>而其余块的颜色显然是随意的，因为联通块的边界都已经被定死了，中间的不一样大不了操作一下就行了。</p>
<p>时间复杂度：$O(nm)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 2100</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fep(i,x,y) for(int i=x;i&lt;=y;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> feq(i,x,y) for(int i=x;i&gt;=y;i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> LL mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="type">char</span> st[N][N];<span class="type">bool</span> v[N][N];</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,st[i]+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">fep</span>(j,<span class="number">1</span>,m<span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(st[i][j]!=st[i][j+<span class="number">1</span>])v[i][j]=v[i][j+<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">2</span>,n)&#123;</span><br><span class="line">        <span class="built_in">fep</span>(j,<span class="number">1</span>,m)&#123;</span><br><span class="line">            <span class="keyword">if</span>(st[i][j]!=st[i<span class="number">-1</span>][j])v[i][j]=v[i<span class="number">-1</span>][j]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    LL ans=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">        <span class="built_in">fep</span>(j,<span class="number">1</span>,m)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!v[i][j])ans=ans*<span class="number">2</span>%mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><p>我们不妨考虑没有双向边的图 G , 和只有双向边的图 G’ 。</p>
<p>显然如果 G’ 为空，那么所有点入度都不为 $0$ 为充要条件。</p>
<p>否则考虑 G’ 中的一个联通块，如果联通块中有一个点在 $G$ 中入度不为 $0$ ，或者是这个联通块的边数≥点数那么这个联通块显然有解，否则无解，然后实现一下即可。</p>
<p>时间复杂度：$O((n+m)\log n)$ 。</p>
<p>最优复杂度：$O(n+m)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 210000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fep(i,x,y) for(int i=x;i&lt;=y;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> feq(i,x,y) for(int i=x;i&gt;=y;i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"><span class="type">const</span> LL mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">set&lt;PII&gt; fuck;</span><br><span class="line"><span class="type">int</span> fa[N],s1[N],s2[N],in[N];</span><br><span class="line">PII a[N];<span class="type">int</span> n,m,nn;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">findfa</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(fa[x]==x)<span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> fa[x]=<span class="built_in">findfa</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mer</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    x=<span class="built_in">findfa</span>(x);y=<span class="built_in">findfa</span>(y);</span><br><span class="line">    <span class="keyword">if</span>(x==y)<span class="keyword">return</span> ;</span><br><span class="line">    fa[x]=y;s1[y]+=s1[x];s2[y]+=s2[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">1</span>,m)&#123;</span><br><span class="line">        <span class="type">int</span> x,y;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);</span><br><span class="line">        fuck.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(x,y));in[y]++;</span><br><span class="line">        <span class="keyword">if</span>(fuck.<span class="built_in">find</span>(<span class="built_in">make_pair</span>(y,x))!=fuck.<span class="built_in">end</span>())&#123;</span><br><span class="line">            a[++nn]=<span class="built_in">make_pair</span>(x,y);in[x]--;in[y]--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">1</span>,n)fa[i]=i,s1[i]=<span class="number">1</span>,s2[i]=in[i];</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">1</span>,nn)&#123;</span><br><span class="line">        <span class="type">int</span> x=a[i].first,y=a[i].second;</span><br><span class="line">        <span class="built_in">mer</span>(x,y);s2[<span class="built_in">findfa</span>(x)]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(fa[i]==i &amp;&amp; s2[i]&lt;s1[i])&#123;<span class="built_in">printf</span>(<span class="string">&quot;NO\n&quot;</span>);<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;YES\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><p>不会</p>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><p>一个很显然的事情，最终的图一定是一堆非叶节点挂着叶子节点的森林。</p>
<p>因为有一个非常显然的事情：</p>
<p><img src="1.png" alt=""></p>
<p>右边的方案肯定比左边的方案要优秀。</p>
<p>那么做法就很简单了，其实就是每个子树在处理完自己之后，需要挑选一个叶子节点送上去。</p>
<p>然后对于一个子树的根节点 $x$ ，其的所有儿子送上权值后，除了被挑选的权值，其余权值都需要乘以自己。</p>
<p>显然，对于一个子树的一个叶子节点，我们需要维护两个信息：这个叶子节点的权值，和这个子树除了这个叶子节点外的最小权值，分别记为 $A,B$ ，不难发现，当根节点面对儿子子树送上来的 $(A,B)$ 时，如果不打算送上去，其产生的贡献为：$A*val_x+B$ ，不难发现，对于儿子子树而言，其需要存储叶子节点个数的 $(A,B)$ ，同时父节点的 $val$ 对于其而言可以说是未知的，而这个统计贡献的方式又是一次函数，所以又是喜闻乐见的维护凸包时间。</p>
<p>那么这个时候每个节点需要干的事情就一个：维护出我自己的凸包。</p>
<p>对于非叶子节点，其每个儿子的凸包的 $B$ 都需要加上其他儿子的贡献，即凸包的上下移动。</p>
<p>而合并凸包可以正常的按秩合并，也可以直接李超线段树合并，时间复杂度都是 $log^2$ 的。</p>
<p>李超线段树的优势是好写，劣势也是有的，因为其的空间比较大，而且是值域线段树，一个 $log$ 是值域的，而且只能处理凸包上下移动，如果是左右移动就寄了，而且如果习惯了写凸包合并实际上也不会比李超线段树难写很多。</p>
<p>时间复杂度：$O(n\log^2{n})$</p>
<h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><p>队友做的题目，赛后我自己来看一眼。</p>
<p>感觉确实还行，但是情况讨论比较逆天。</p>
<p>简单来说，这道题目有一个性质：</p>
<p>就是我们假设我们需要的修改的最左边的位置为 $l$ ，那么显然需要修改的最右边的位置为 $r$ 。</p>
<p>那么对于任意一个最优解，我们用一个最小的区间 $[a,b]$ 包住我们所有修改过的位置，则 $a=l$ 和 $b=r$ 至少有其一可以成立。</p>
<p>因此。我们先忽略走路的代价，然后预处理出 $[l,i]$ 和 $[i,r]$ 的最小修改代价。</p>
<p>然后就是处理每个区间对于 $i$ 的贡献了，这就非常的简单了。</p>
<p>例如 $[l,i]$ 对于 $j(j\ge l)$  的贡献分为两种，先走到 $l$ ，再走到 $i$ ，这可以在从小到大遍历时处理，也可以先走 $i$ 再走 $l$ ，这可以从大到小遍历时枚举。</p>
<p>然后只要能够讨论出所有情况，这道题目就做完了。</p>
<p>时间复杂度：$O(n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="comment">//#define DEBUG</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 1100000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fep(i,x,y) for(int i=x;i&lt;=y;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> feq(i,x,y) for(int i=x;i&gt;=y;i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> LL inf=(LL)<span class="number">1e15</span>;</span><br><span class="line"><span class="type">char</span> st[N];</span><br><span class="line">LL C,a[N],f1[N],f2[N];</span><br><span class="line">LL ans[N];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(LL *f,<span class="type">int</span> l,<span class="type">int</span> r,LL sum)</span></span>&#123;f[l]+=sum;f[r+<span class="number">1</span>]-=sum;&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%lld&quot;</span>,&amp;n,&amp;C);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,st+<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> l=<span class="number">0</span>,mid=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;a[i]);</span><br><span class="line">            f1[i]=f2[i]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n/<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(st[i]!=st[n-i+<span class="number">1</span>])&#123;l=i;<span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">feq</span>(i,n/<span class="number">2</span>,<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(st[i]!=st[n-i+<span class="number">1</span>])&#123;mid=i;<span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!l)&#123;</span><br><span class="line">            <span class="built_in">fep</span>(i,<span class="number">1</span>,n)<span class="built_in">printf</span>(<span class="string">&quot;0 &quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">ifdef</span> DEBUG</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,st+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,l);</span><br><span class="line">        <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">change</span>(f1,<span class="number">1</span>,mid<span class="number">-1</span>,inf);<span class="built_in">change</span>(f2,n-mid+<span class="number">2</span>,n,inf);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=l;i+i&lt;=n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(st[i]==st[n-i+<span class="number">1</span>])<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(a[i]&lt;=a[n-i+<span class="number">1</span>])&#123;</span><br><span class="line">                <span class="built_in">change</span>(f1,i,n,a[i]);</span><br><span class="line">                <span class="built_in">change</span>(f2,i+<span class="number">1</span>,n-i+<span class="number">1</span>,a[n-i+<span class="number">1</span>]);</span><br><span class="line">                <span class="built_in">change</span>(f2,<span class="number">1</span>,i,a[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">change</span>(f2,<span class="number">1</span>,n-i+<span class="number">1</span>,a[n-i+<span class="number">1</span>]);</span><br><span class="line">                <span class="built_in">change</span>(f1,i,n-i,a[i]);</span><br><span class="line">                <span class="built_in">change</span>(f1,n-i+<span class="number">1</span>,n,a[n-i+<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)f1[i]+=f1[i<span class="number">-1</span>],f2[i]+=f2[i<span class="number">-1</span>];</span><br><span class="line">        <span class="meta">#<span class="keyword">ifdef</span> DEBUG</span></span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)<span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>,f1[i],f2[i]);</span><br><span class="line">        <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="type">int</span> r=n-l+<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// fep(i,l,n-l+1)f1[i]+=(i-l)*C,f2[i]=(r-i)*C;</span></span><br><span class="line">        LL now1=inf,now2=inf,now3=inf;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">            now1=<span class="built_in">min</span>(now1,<span class="built_in">min</span>(f1[i]-C*l,f2[i]+C*(r-i)-C*i));</span><br><span class="line">            now2=<span class="built_in">min</span>(now2,f2[i]+C*(r-i)+C*r);</span><br><span class="line">            now3=<span class="built_in">min</span>(now3,f2[i]-i*C);</span><br><span class="line">            <span class="keyword">if</span>(i&gt;r)now2=inf;</span><br><span class="line">            ans[i]=<span class="built_in">min</span>(now1+C*i,now2-C*i);</span><br><span class="line">            <span class="keyword">if</span>(i&gt;=r)ans[i]=<span class="built_in">min</span>(ans[i],now3+i*C);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="keyword">ifdef</span> DEBUG</span></span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,ans[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        now1=inf;now2=inf;now3=inf;</span><br><span class="line">        <span class="built_in">feq</span>(i,n,<span class="number">1</span>)&#123;</span><br><span class="line">            now1=<span class="built_in">min</span>(now1,f1[i]+(i-l)*C-l*C);</span><br><span class="line">            now2=<span class="built_in">min</span>(now2,<span class="built_in">min</span>(f2[i]+r*C,f1[i]+C*(i-l)+C*i));</span><br><span class="line">            now3=<span class="built_in">min</span>(now3,f1[i]+i*C);</span><br><span class="line">            <span class="keyword">if</span>(i&lt;l)now1=inf;</span><br><span class="line">            ans[i]=<span class="built_in">min</span>(ans[i],<span class="built_in">min</span>(now1+i*C,now2-i*C));</span><br><span class="line">            <span class="keyword">if</span>(i&lt;=l)ans[i]=<span class="built_in">min</span>(ans[i],now3-i*C);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,ans[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="F"><a href="#F" class="headerlink" title="F"></a>F</h1><p>本场最逆天的大贪心题，但实际上只要你建了个好模，能够从一个合适的角度思考，这道题目其实也不是很难。</p>
<p>当然，这道题目其实也有一个方法可以快速的做出来，就是你先想一个最简单的贪心，然后尝试构造数据卡掉这个贪心，然后研究一下错误的原因，想办法解决，大概率就能在较短的时间做出来这道题目。</p>
<p>例如：</p>
<p>一个比较简单的贪心，我们认为肯定是存在一个分界线，这个分界线往上都是漂亮的，往下都是不漂亮的。</p>
<p>这样存在数据：</p>
<p>1 1 1 2 3 3 3 4 4 4</p>
<p>这个数据应该选择 $1,2$ 作为每一段的分界点。</p>
<p>分析一下选两个 $1$ 和 $1,2$ 的区别在于段数的变化，</p>
<p>一个有四段，一个只有三段，因此，这也就引出了另外一个队伍的做法：</p>
<p>从小到大，根据当前已经选择的分界点和段数，判断是否还需要新增分界点，如果需要，就从最短的段中扔出一个数字作为分界点，显然的事情是这样一定存在一个方案使得我们选择的数字都是漂亮的，而且这也一定是最优方案，因为每次选择分界点都是迫不得已且已经尽可能的让段数减少了。</p>
<details class="toggle" ><summary class="toggle-button" style="">不过这是别的队的做法，我的做法是反过来的。</summary><div class="toggle-content"><p>我的做法是从大到小，根据现在的分界点和段数，适当的让段数延长或者新增一个段，是反过来的。</p>
<p>至于上面两个做法的严谨证明，可以自行证明。</p>
<p>不过对于我的做法，我可以简单的阐释一下证明过程：</p>
<p>首先发现一个检验模型，即一个段视为 $1$ ，一个分界点视为 $-1$ ，从大到小求和，且每当和 $&lt;1$ 时就重置为 $1$ ，这样只要求完后和为 $1$ ，那么就至少存在一个方案使得漂亮数的数量大于等于目前我们所选的漂亮数。</p>
<p>然后根据这个模型，我们可以证明一定存在一个最优方案使得 $sum$ 只能在最后一步才能出现重置的情况，所以我们不妨加上这个限制求最优方案。</p>
<p>因此，做法便为每次发现可能需要重置时，调整方案使得其不会重置，且这个过程采用贪心使其最优化。</p>
<p>用到的思想为：如果对于一个方案集：$S$ ，其中 $S’\subseteq S$ ，且存在最优方案使得 $x\in S’$ ，则可以把在 $S$ 上求最优方案改成在 $S’$ 上求最优方案。</p>
<p>贪心的证明还是那个老方法：</p>
<p>在算法进行的过程中，当需要我们新增段数时，我们新增了段数，显然会导致方案无效，当需要我们新增或者延长时，触发连招：</p>
<p>假如存在一个满足之前条件的最优方案不放在这里，那么一定存在一个满足之前条件的最优方案放在这里。显然，因为我们加入了满足之前条件这个限制，所以不会导致循环论证。</p>
<p>准确来说，只要你找到一个最优方案满足当前的限制条件又不会破坏之前的限制条件，就不会循环论证，而上面的调整显然调整的是一个新的漂亮数的位置，并不会影响到之前已经固定下来的漂亮数的位置，所以自然也就不会循环论证了。</p>
<p>说起循环论证，我一开始在做这道题目的时候方向错了，就出现了一个非常有意思的事情：</p>
<p>我发现了三个性质，用调整都可以证明存在一个最优方案满足这个条件，但是最尴尬的事情是我无法证明他们可以被同时满足。</p>
<p>即可能存在以下情况：一个最优方案，我调整了一下，满足性质 $1$ ，又调整了一下，满足了性质 $2$ ，结果不满足性质 $1$ 了，循环往复，这样就陷入了循环论证当中。</p>
<p>不过还好后来转换了想题思路，没过多久就想出来了，也算没坑队友太久。</p>
</div></details>
<p>时间复杂度：$O(n\log{n})$</p>
<p>这道题目非常有意思，刚拿起此题，都会凭借直觉想出一个简单的贪心，然后发现WA了，但是能说直觉做题法错了吗？其实也没错，因为只要你做了足够多的贪心题，你就会在想出这个贪心做法的时候感觉这个做法总会有一点点问题，问题应该是出在数字允许相同这个条件上，然后自己尝试卡一下，就会发现一个 hack 数据，在发现错误原因后，就能慢慢想出正确做法了，所以虽然一开始是错的，但是直觉做题法还是能帮助我们逐步想出正解的。</p>
<p><del>也不排除有逆天直接就想到了正确的做法，如果你直接想出了做法，请忽略上面的话。</del></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 310000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fep(i,x,y) for(int i=x;i&lt;=y;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> feq(i,x,y) for(int i=x;i&gt;=y;i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">priority_queue&lt;<span class="type">int</span>&gt; fuck;</span><br><span class="line"><span class="type">int</span> n,a[N],ans;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x&gt;y;&#125;</span><br><span class="line"><span class="type">int</span> now;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="keyword">while</span>(!fuck.<span class="built_in">empty</span>())fuck.<span class="built_in">pop</span>();</span><br><span class="line">        ans=now=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">        <span class="built_in">sort</span>(a+<span class="number">1</span>,a+n+<span class="number">1</span>,cmp);</span><br><span class="line">        <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i]!=a[i<span class="number">-1</span>])&#123;</span><br><span class="line">                <span class="type">int</span> x=i;<span class="keyword">while</span>(x&lt;n &amp;&amp; a[x+<span class="number">1</span>]==a[x])x++;</span><br><span class="line">                fuck.<span class="built_in">push</span>(x-i+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            res--;</span><br><span class="line">            <span class="keyword">if</span>(!now)&#123;</span><br><span class="line">                <span class="keyword">if</span>(res&lt;<span class="number">0</span> || (!res &amp;&amp; i!=n))&#123;</span><br><span class="line">                    now=fuck.<span class="built_in">top</span>();fuck.<span class="built_in">pop</span>();res+=<span class="number">2</span>;</span><br><span class="line">                    ans++;now--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(now &amp;&amp; !res)now--,res++,ans++;</span><br><span class="line">            <span class="comment">// printf(&quot;%d %d %d\n&quot;,now,res,ans);</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="G"><a href="#G" class="headerlink" title="G"></a>G</h1><p>非常的简单，首先让全局都变成 $2$ ，这样就变成了单点修改，然后根据需要放 $3$ 就行了。</p>
<p>时间复杂度：$O(nm)$ 。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fep(i,x,y) for(int i=x;i&lt;=y;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> feq(i,x,y) for(int i=x;i&gt;=y;i--)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 2100</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">char</span> st[N][N],ans[N][N];</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,st[i]+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">fep</span>(j,<span class="number">1</span>,m)&#123;</span><br><span class="line">            ans[i][j]=<span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">            <span class="type">int</span> nex=<span class="number">4</span>-(i==<span class="number">1</span>)-(j==<span class="number">1</span>)-(i==n)-(j==m);</span><br><span class="line">            <span class="keyword">if</span>((nex&amp;<span class="number">1</span>)^(st[i][j]==<span class="string">&#x27;B&#x27;</span>))ans[i][j]=<span class="string">&#x27;3&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,ans[i]+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="H"><a href="#H" class="headerlink" title="H"></a>H</h1><p>不会</p>
<h1 id="I"><a href="#I" class="headerlink" title="I"></a>I</h1><p>显然，割点就走不过去了。</p>
<p>然后我们写了一棵圆方树，然后调了一万年，艹！</p>
<p>当然，实际上这道题目存在更加优秀的做法，就是直接在 $DFS$ 树上跑。</p>
<p>我们实际上想要知道一个点在圆方树上是在这个割点的哪个子树里面，更准确的说，是想要知道原图上某个点不经过某个割点不能走到的区域的大小。</p>
<p>不难发现，例如当 $x$ 是割点时，此时有三种情况。（$siz[x]$ 表示 $x$ 的子树大小，$siz’[x]$ 表示 $x$ 子树中满足 $y$ 是 $x$ 儿子且 $low[y]\geq dfn[x]$ 的 $y$ 的子树大小之和）</p>
<ol>
<li>$y$ 的祖先是 $x$ ，那么此时 $siz’[x]$ 就是不能走到的区域大小。</li>
<li>设 $z$ 为 $y$ 的祖先且为 $x$ 的儿子。<ol>
<li>假设 $low[z]\ge dfn[x]$ ，则 $n-siz[z]-1$ 就是无法走到的区域大小。</li>
<li>假设 $low[z]&lt;dfn[x]$ ，则 $siz’[x]$ 就是无法走到的区域大小。</li>
</ol>
</li>
</ol>
<p>然后就可以不用建出圆方树了，也就可以不用调一万年了，悲。</p>
<p>不过非圆方树的做法是口胡的，还没验证，有时间验证一下。</p>
<p>时空复杂度：$O(m+(n+q)\log{n})$。</p>
<p>事实上预处理一下，可以在 $O(n+m+q)$ 的时空内解决这道题目。</p>
<h1 id="J"><a href="#J" class="headerlink" title="J"></a>J</h1><p>队友做的，但是我也参与讨论了。</p>
<ol>
<li>某个颜色的被删除点对肯定是包含和被包含关系的，且如果剩下来一个数字，那一定是中间那个。<br>即如果某个颜色存在点对 $(a_1,b_1),(a_2,b_2)$ ，那么一定存在关系：$a_1&gt;a_2,b_1&lt;b_2$ 或者反过来。<br>证明方式就是如果存在违规点对，把早出现的点对变成大区间，晚出现的变成小区间，可以证明一定不劣。<br>可以发现，经过这样的调整，区间长度的平方和一定减小，所以这样的调整一定会结束。<br>至于只会剩下中间那个，类似证明即可。</li>
<li>一定存在一个最优方案使得删除顺序为长度长的优先。<br>类似上面的，每次交换相邻两个点对然后证明不劣就行了。</li>
</ol>
<p>排个序然后用树状数组维护一下就行了。</p>
<p>时间复杂度：$O(n\log{n})$ 。</p>
<p>同时也可以发现，这个做法很符合正常人的直觉：删大区间对剩下区间的影响最小，所以优先删最大的区间。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 310000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fep(i,x,y) for(int i=x;i&lt;=y;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> feq(i,x,y) for(int i=x;i&gt;=y;i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"><span class="type">const</span> LL mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> bst[N],n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> x&amp;-x;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(x&lt;=n)bst[x]+=k,x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">findans</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)ans+=bst[x],x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; a[N];</span><br><span class="line">PII b[N];<span class="type">int</span> top;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(PII x,PII y)</span></span>&#123;<span class="keyword">return</span> (x.second-x.first)&gt;(y.second-y.first);&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        top=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">            <span class="type">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">            a[x].<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">            <span class="type">int</span> siz=a[i].<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j+j&lt;=siz;j++)b[++top]=<span class="built_in">make_pair</span>(a[i][j<span class="number">-1</span>],a[i][siz-j]);</span><br><span class="line">            a[i].<span class="built_in">clear</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(b+<span class="number">1</span>,b+top+<span class="number">1</span>,cmp);</span><br><span class="line">        LL ans=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,top)&#123;</span><br><span class="line">            ans+=b[i].second-b[i].first-<span class="built_in">findans</span>(b[i].second)+<span class="built_in">findans</span>(b[i].first);</span><br><span class="line">            <span class="built_in">change</span>(b[i].first,<span class="number">1</span>);<span class="built_in">change</span>(b[i].second,<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">        <span class="built_in">memset</span>(bst+<span class="number">1</span>,<span class="number">0</span>,(n&lt;&lt;<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="K"><a href="#K" class="headerlink" title="K"></a>K</h1><p>感觉其实还没 $F$ 难。</p>
<p>重点是要发现一个性质，当我连接 $i,j$ 且 $|j-i|=2$ 时，相当于直接删除了中间的数字，然后根据这个构造上界即可。</p>
<p>考虑从小到大遍历一个最优方案。</p>
<p>首先，对于 $|j-i|=1$ 的边，能连就连。(后面默认这一部分边都已经连上了)</p>
<p>对于 $|j-i|&gt;1$ 的边，显然我们每次连都会导致中间的点不能再用了（因为我们从小到大遍历边的），保持遍历边的顺序不变，假如我们直接把中间点给删了，就会发现对于任意时刻的序列，对于能连的 $|j-i|=1$ 的边也都是连上的，也就是在新序列中，下一条边的 $|j-i|$ 仍然 $&gt;1$ 。</p>
<p>所以我们就不难发现一个上界：$(n-1)+(n-2)=2n-3$ 。</p>
<p>现在我们先把 $|j-i|=1$ 的点连了，同时需要注意：序列最左边和最右边是一直不会被删除的，他们之间的连边对全局不会有影响，能连就连，不能连就算了（和 $|j-i|=1$ 的边是一个性质的）。</p>
<p>所以，如果序列左右两边的颜色如果相同，那么至少剩下 $3$ 个数字，不同 ，至少剩下两个数字。</p>
<p>然后就是讨论：</p>
<ol>
<li>$m≥3$ ，考虑每次连边删去中间的点。<ol>
<li>那么无论任何时候，都存在一个点可以被删除（即连接其相邻的两个点）。</li>
<li>如果有一个颜色被删除到只剩一个，那么显然其可以向剩余所有点连边，最后会剩下三个数字。</li>
<li>如果序列两边两个数字不同，连边。</li>
</ol>
</li>
<li>$m=2$ ，不妨变成 $01$ 序列，定义联通块为相同颜色的区间，最大联通块是以某个位置能延申出去的最长连通块，连通块个数是最大连通块个数。<ol>
<li>如果我们只删除一个数字，那么连通块个数不变。</li>
<li>连边只会导致：连通块长度减小，连通块个数减少，不会导致连通块长度增加。</li>
<li>因此，只删一个数字的操作次数上限为：连通块长度-1 的和。</li>
<li>显然，接下来只进行删除两个数字的操作是最优秀的，也显然可以办到，最终结果为 $010/101/01/10$ ，都是最优的终止状态，因此这样子操作下来就是边数的上限。</li>
</ol>
</li>
</ol>
<p>然后照着做就完了，时间复杂度：$O(n)$ 。</p>
<details class="toggle" ><summary class="toggle-button" style="">上面的是别的队的做法，我原来答辩到爆炸的做法在这</summary><div class="toggle-content"><p>$m\ge 3$ 的情况，我是这么做的：</p>
<ol>
<li>首先把每个连通块消到只剩 $1$ 个数字。</li>
<li>然后乱删，直到只剩下三个颜色且其中一个颜色只剩下一个数字。</li>
<li>然后尝试删除出现次数最多的颜色，失败，且如果出现次数第二多的颜色出现了至少两次，则删除且一定能成功，反之退出，或者直到只剩两个颜色时退出。</li>
</ol>
<p>显然，此时终止状态不多，以 $0,1,2$ 表示（$0$ 出现次数最多，$1$ 次多，$2$ 最少，只出现了一次）：</p>
<p>长度为 $4$ 的：$0120$</p>
<p>长度为 $3$ 的：$012,021,020$</p>
<p>长度为 $2$ 的：$12$ </p>
<p>然后再特判一下，就做完了。</p>
<p>MD，这个做法本来就答辩，打代码加思考细节就只有半个小时时间，笑死，根本写不完，然后这道题目赛时就没做出来了，不过也是我的问题，毕竟这个做法本来也是我想的，要是我能想出别的队的那个做法，估计是有可能能写出来的，毕竟他们那个做法比我的做法好写太多了。</p>
<p>而且我这个做法的细节处理也是有点冗杂的，实际上第 $3$ 步能改成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">然后尝试删除出现次数最多的颜色，失败，则删除出现次数第二多的颜色，再失败，则删除出现次数第三多的，直到只剩两个颜色时退出。</span><br></pre></td></tr></table></figure>
<p>这个修改只不过是把处理终止状态的步骤和第 $3$ 步尝试删除的部分融合了，观察一下上面所剩下的终止状态就可以发现这个修改是显然正确的。</p>
</div></details>
<p>由于是赛后补的题目，所以采用的是别的队伍的做法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 210000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NN 410000</span></span><br><span class="line"><span class="comment">// #define DEBUG</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fep(i,x,y) for(int i=x;i&lt;=y;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> feq(i,x,y) for(int i=x;i&gt;=y;i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line">PII sta[NN];<span class="type">int</span> top;</span><br><span class="line"><span class="type">int</span> n,col[N],cc[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    <span class="type">int</span> l,r;</span><br><span class="line">&#125;li[N];<span class="type">bool</span> v[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del_f</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;li[li[x].r].l=li[x].l;li[li[x].l].r=li[x].r;&#125;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; fuck;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> !v[x] &amp;&amp; li[x].l &amp;&amp; li[x].r&lt;=n &amp;&amp; col[li[x].l]!=col[li[x].r];&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> lef=li[x].l,rig=li[x].r;</span><br><span class="line">    v[x]=<span class="number">1</span>;<span class="built_in">del_f</span>(x);sta[++top]=<span class="built_in">make_pair</span>(lef,rig);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">check</span>(lef))fuck.<span class="built_in">push_back</span>(lef);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">check</span>(rig))fuck.<span class="built_in">push_back</span>(rig);</span><br><span class="line">    cc[col[x]]--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">fep</span>(i,<span class="number">1</span>,n)li[i].l=i<span class="number">-1</span>,li[i].r=i+<span class="number">1</span>;</span><br><span class="line">    li[n+<span class="number">1</span>].l=n;li[<span class="number">0</span>].r=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">ifdef</span> DEBUG</span></span><br><span class="line">        <span class="built_in">freopen</span>(<span class="string">&quot;std.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">        <span class="built_in">init</span>();top=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;col[i]);cc[col[i]]++;</span><br><span class="line">            <span class="keyword">if</span>(i!=<span class="number">1</span> &amp;&amp; col[i]!=col[i<span class="number">-1</span>])sta[++top]=<span class="built_in">make_pair</span>(i<span class="number">-1</span>,i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">check</span>(i))fuck.<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> pre=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">2</span>,n)&#123;</span><br><span class="line">            <span class="keyword">if</span>(col[i]!=col[i<span class="number">-1</span>])!pre?pre=i<span class="number">-1</span>:<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(pre)<span class="built_in">del</span>(i<span class="number">-1</span>);            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// #ifdef DEBUG</span></span><br><span class="line">        <span class="comment">// printf(&quot;%d\n&quot;,top);</span></span><br><span class="line">        <span class="comment">// fflush(stdout);</span></span><br><span class="line">        <span class="comment">// #endif</span></span><br><span class="line">        <span class="built_in">feq</span>(i,pre,<span class="number">2</span>)<span class="built_in">del</span>(i);</span><br><span class="line">        <span class="comment">// #ifdef DEBUG</span></span><br><span class="line">        <span class="comment">// printf(&quot;%d\n&quot;,top);</span></span><br><span class="line">        <span class="comment">// fflush(stdout);</span></span><br><span class="line">        <span class="comment">// #endif</span></span><br><span class="line">        <span class="keyword">if</span>(m==<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="type">int</span> x=li[<span class="number">0</span>].r,type=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(x!=n+<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(li[x].l!=li[<span class="number">0</span>].r &amp;&amp; !type)sta[++top]=<span class="built_in">make_pair</span>(li[<span class="number">0</span>].r,x);</span><br><span class="line">                x=li[x].r;type^=<span class="number">1</span>;</span><br><span class="line">                <span class="comment">// printf(&quot;%d\n&quot;,x);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> x=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">                x=fuck[fuck.<span class="built_in">size</span>()<span class="number">-1</span>];fuck.<span class="built_in">pop_back</span>();</span><br><span class="line">                <span class="keyword">if</span>(!<span class="built_in">check</span>(x))<span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span>(cc[col[x]]==<span class="number">1</span>)<span class="keyword">break</span>;</span><br><span class="line">                <span class="built_in">del</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// printf(&quot;OK\n&quot;);</span></span><br><span class="line">            <span class="type">int</span> now=li[<span class="number">0</span>].r;</span><br><span class="line">            <span class="keyword">while</span>(now!=n+<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(now!=x &amp;&amp; li[now].l!=x &amp;&amp; li[now].r!=x)sta[++top]=<span class="built_in">make_pair</span>(now,x);</span><br><span class="line">                now=li[now].r;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(col[<span class="number">1</span>]!=col[n])sta[++top]=<span class="built_in">make_pair</span>(<span class="number">1</span>,n);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,top);</span><br><span class="line">        <span class="built_in">fep</span>(i,<span class="number">1</span>,top)<span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,sta[i].first,sta[i].second);</span><br><span class="line">        <span class="built_in">memset</span>(cc+<span class="number">1</span>,<span class="number">0</span>,m&lt;&lt;<span class="number">2</span>);</span><br><span class="line">        <span class="comment">// memset(col,0,sizeof(col));</span></span><br><span class="line">        <span class="comment">// memset(li,0,sizeof(li));</span></span><br><span class="line">        <span class="built_in">memset</span>(v+<span class="number">1</span>,<span class="number">0</span>,n);</span><br><span class="line">        <span class="comment">// memset(v,0,sizeof(v));</span></span><br><span class="line">        <span class="comment">// memset(sta,0,sizeof(sta));</span></span><br><span class="line">        fuck.<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h1><ol>
<li>亲手写一些代码，例如：口胡或者知道做法但是没有写的题目。</li>
<li>把没有做的题目自己做一遍。</li>
<li>自己去看一遍官方题解并且补充一下官方题解的做法。</li>
<li>去把合并凸包的两种方式都写一遍并且写一篇博客。</li>
<li>补充一下线段树合并时间复杂度的证明：常规证明，和从按秩合并的角度理解的证明（刘家宁提供的角度）。</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://oldplace.github.io">player</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://oldplace.github.io/2025/02/04/2022-2023-Winter-Petrozavodsk-Camp-D2-%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/">http://oldplace.github.io/2025/02/04/2022-2023-Winter-Petrozavodsk-Camp-D2-%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://oldplace.github.io" target="_blank">Oldplace</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/my%20avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/my%20avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">player</div><div class="author-info__description">一个蒟蒻在网络上的温馨小窝</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">159</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">70</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/oldplace" target="_blank" title="Github"><i class="fa-brands fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="https://www.luogu.com.cn/user/65602" target="_blank" title="洛谷"><i class="iconfont icon-luogu" style="color: #1461e6;"></i></a><a class="social-icon" href="https://www.codeforces.com/profile/zhangjianjuncd" target="_blank" title="CodeForces"><i class="fa-solid fa-chart-simple" style="color: #fd9d17;"></i></a><a class="social-icon" href="https://atcoder.jp/users/juruozjj" target="_blank" title="AtCoder"><i class="fa-solid fa-a" style="color: #7e0101;"></i></a><a class="social-icon" href="https://loj.ac/u/zhangjianjunab" target="_blank" title="LibreOJ"><i class="fa-solid fa-l" style="color: #9fa4ad;"></i></a><a class="social-icon" href="https://uoj.ac/user/profile/zhangjianjunab" target="_blank" title="Universal Online Judge"><i class="fa-solid fa-u" style="color: #ece509;"></i></a><a class="social-icon" href="https://ac.nowcoder.com/acm/contest/profile/485838814" target="_blank" title="牛客竞赛"><i class="iconfont icon-niu1" style="color: #3c5867;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#A"><span class="toc-number">1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#B"><span class="toc-number">2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#C"><span class="toc-number">3.</span> <span class="toc-text">C</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#D"><span class="toc-number">4.</span> <span class="toc-text">D</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#E"><span class="toc-number">5.</span> <span class="toc-text">E</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#F"><span class="toc-number">6.</span> <span class="toc-text">F</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#G"><span class="toc-number">7.</span> <span class="toc-text">G</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#H"><span class="toc-number">8.</span> <span class="toc-text">H</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#I"><span class="toc-number">9.</span> <span class="toc-text">I</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#J"><span class="toc-number">10.</span> <span class="toc-text">J</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#K"><span class="toc-number">11.</span> <span class="toc-text">K</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9D%91"><span class="toc-number">12.</span> <span class="toc-text">坑</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By player</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>function loadUtterances () {
  let ele = document.createElement('script')
  ele.setAttribute('id', 'utterances_comment')
  ele.setAttribute('src', 'https://utteranc.es/client.js')
  ele.setAttribute('repo', 'oldplace/oldplace.github.io')
  ele.setAttribute('issue-term', 'pathname')
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
  ele.setAttribute('theme', nowTheme)
  ele.setAttribute('crossorigin', 'anonymous')
  ele.setAttribute('async', 'true')
  document.getElementById('utterances-wrap').insertAdjacentElement('afterbegin',ele)
}

function utterancesTheme (theme) {
  const iframe = document.querySelector('.utterances-frame')
  if (iframe) {
    const theme = theme === 'dark' ? 'photon-dark' : 'github-light'
    const message = {
      type: 'set-theme',
      theme: theme
    };
    iframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }
}

btf.addModeChange('utterances', utterancesTheme)

if ('Utterances' === 'Utterances' || !true) {
  if (true) btf.loadComment(document.getElementById('utterances-wrap'), loadUtterances)
  else loadUtterances()
} else {
  function loadOtherComment () {
    loadUtterances()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>