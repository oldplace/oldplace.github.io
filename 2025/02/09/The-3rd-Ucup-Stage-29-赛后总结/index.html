<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>The 3rd Ucup Stage 29 赛后总结 | Oldplace</title><meta name="author" content="player"><meta name="copyright" content="player"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="比赛链接：https:&#x2F;&#x2F;qoj.ac&#x2F;contest&#x2F;1913 这场比赛的签到感觉没啥问题，也许？如果说英语水平算问题的话，那我确实读题太慢了，最需要训练的人是你呀。而且某人在队长说完之后还 WA 了一发 C 确实有点铸币了。 然后后面就陆陆续续的做各种题，队友在牢 B ，我发现 C 是 SB 就开写了。 然后等 C 过了后，队友因为有事离开，队长开始赤队友没做完的石，开始重复对吗？对的。真对吗">
<meta property="og:type" content="article">
<meta property="og:title" content="The 3rd Ucup Stage 29 赛后总结">
<meta property="og:url" content="http://oldplace.github.io/2025/02/09/The-3rd-Ucup-Stage-29-%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Oldplace">
<meta property="og:description" content="比赛链接：https:&#x2F;&#x2F;qoj.ac&#x2F;contest&#x2F;1913 这场比赛的签到感觉没啥问题，也许？如果说英语水平算问题的话，那我确实读题太慢了，最需要训练的人是你呀。而且某人在队长说完之后还 WA 了一发 C 确实有点铸币了。 然后后面就陆陆续续的做各种题，队友在牢 B ，我发现 C 是 SB 就开写了。 然后等 C 过了后，队友因为有事离开，队长开始赤队友没做完的石，开始重复对吗？对的。真对吗">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://oldplace.github.io/img/my%20avatar.jpg">
<meta property="article:published_time" content="2025-02-09T14:37:53.000Z">
<meta property="article:modified_time" content="2025-02-10T04:22:05.198Z">
<meta property="article:author" content="player">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://oldplace.github.io/img/my%20avatar.jpg"><link rel="shortcut icon" href="/img/author16.png"><link rel="canonical" href="http://oldplace.github.io/2025/02/09/The-3rd-Ucup-Stage-29-%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'The 3rd Ucup Stage 29 赛后总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2025-02-10 12:22:05'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4233465_4sh0n7ckry.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/my%20avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">158</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">70</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Oldplace"><span class="site-name">Oldplace</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">The 3rd Ucup Stage 29 赛后总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-02-09T14:37:53.000Z" title="发表于 2025-02-09 22:37:53">2025-02-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-10T04:22:05.198Z" title="更新于 2025-02-10 12:22:05">2025-02-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BF%A1%E6%81%AF%E5%AD%A6/">信息学</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>37分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="The 3rd Ucup Stage 29 赛后总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><p>比赛链接：<a target="_blank" rel="noopener" href="https://qoj.ac/contest/1913">https://qoj.ac/contest/1913</a></p>
<p>这场比赛的签到感觉没啥问题，也许？如果说英语水平算问题的话，那我确实读题太慢了，最需要训练的人是你呀。而且某人在队长说完之后还 WA 了一发 C 确实有点铸币了。</p>
<p>然后后面就陆陆续续的做各种题，队友在牢 B ，我发现 C 是 SB 就开写了。</p>
<p>然后等 C 过了后，队友因为有事离开，队长开始赤队友没做完的石，开始重复对吗？对的。真对吗？好像是对的的话<del>就在我庆幸牢的不是我的时候，一个小时后回旋镖击中了我</del>。</p>
<p>接着发现 G 也是 SB 后接着写，过了 G 以后开 D ，感觉也不难，就直接开了。一个小时过了 D ，一个半小时过了 B 。</p>
<p>写完 D 后开 E ，其实 E 如果逐步推进结论就会发现结论挺显然的，但是我一开始结论猜偏了，猜了一个等价但是繁琐很多的命题，等到后面代码写到一半了才发现了更加简单的命题，虽然实现上没变化，但是从繁琐的结论开始想实现方式还是花了不少时间，半年没打熟练度下降好快<del>果然最该训练的人是你呀</del>。</p>
<p>正常情况下这个时候应该要找队长反馈情况了，毕竟赛时知道结论后，想怎么写想了这么久有点抽象了，但是队长在牢 B ，悲，果然队伍还是要有人统领全局。（感觉我确实代码实现能力不太行，赛时如果不知道怎么写还是应该及时问队友，总之不会问队友就行了，队友总能解决的）</p>
<p>然后慢悠悠的写 E ，两个小时过了，不得不说，现在写代码速度也好慢，在学会 vim 后会快一点吗？不过制约我打字速度的真不是因为铸币脑子吗？</p>
<p>然后就是讨论 J ，虽然很不想写这坨屎，但是数据结构大师不在，显然只能我吃了，前面写个扫描线，后面的部分还好可以用树状数组 + DFS 序避免树链剖分，但依旧写了一个小时，在 2:40 的时候调完扫描线，因为线段树建树时没有给左右儿子赋值的幽默错误，甚至队长还感叹一句：“我还以为你写完了，原来才刚建完树”。中大半小时写完是什么怪物啊。</p>
<p>然后就是讨论 F ，说句实话，一开始就知道是半在线 NTT 了，不过一直不相信罢了，我是真不信会有人放一道裸半在线 NTT 在赛场啊。</p>
<p>然后因为各种原因，不信是半在线 NTT ，所以在想有没有可能有别的做法；然后主观上不太想写多项式，一直拖着；然后一开始的 dp 转移式我以为是 4 个半在线 NTT；最后有个除法，万一写完后分母是 0 就 see you again 了。虽然在正赛上肯定得写，就算是分母可能为 0 也得写，赛场上想不出正解不是大事，没 AC 才是大事。</p>
<p>拖拉到一个小时，队长可能也看出来我怠工了，拉我去讨论他的 M ，可惜我并不会圆反演，在提出了几个观点后就接着想 F 去了。</p>
<p>然后拖拉到最后四十分钟，终于准备写了，队友也复活了，队友去处理队长的 M ，我在具体写 dp 式子。（是的，我前面的转移式都仅仅是存在于脑子里面，细节什么的都还没想）</p>
<p>然后不喜欢动笔的习惯发力了，因为做题长时间不动笔，导致遇到这种需要动笔写转移式的题就猪脑过载，写了一半发现可以变成两个半在线 NTT ，然后接着搁那列式，思考这个转化的组合意义（我的习惯，思考明白组合意义能让我对这个转移式的正确性更有把握一点），然后过载着过载着就只剩下十分钟了，然后来不及写，直接暴寄，最后一看做法是半在线 NTT ，真放板在比赛里面啊，不是。</p>
<p>不过过载半小时没写出 dp 转移式也是真神人了，确实需要练习吧。怎么练习呢？平时做 dp 题之前能不能把 dp 转移式先在纸上写出来，然后争取一遍写对啊。</p>
<p>队友的 M 大战了许久之后没过，赛后发现不用圆反演，遂小丑。我感觉我在这道题目的问题就是我只是在听他们的做法，我并没有自己想想有没有别的简单搞法，方便最后如果过不去的话，能给队友提供多一些乱搞的选择，不过鉴于那时队友做法成型，我手里也有 F ，其实这个行为的优先级并不高。不过正赛肯定要这么干了，因为最后一小时肯定先保队长这个已经写完的题，F 肯定就丢掉了，不存在我手里还有 F 的说法。</p>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><p>tag：博弈</p>
<details class="toggle" ><summary class="toggle-button" style="">做法</summary><div class="toggle-content"><p>注意到每个人接触到的数字的奇偶性相同，又注意到奇数只会被接触奇数的人删除就知道做法了，接下来就只需要讨论了。</p>
<p>怎么注意到的？我也想知道，队长做出来的。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="type">int</span> l, r;</span><br><span class="line">        cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">        <span class="type">int</span> type = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(l &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>((r - l + <span class="number">1</span>) &amp; <span class="number">1</span>) type = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="number">2</span> * l &lt;= r) type = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">else</span> type = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>((r - l + <span class="number">1</span>) &amp; <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="number">2</span> * (l + <span class="number">1</span>) &lt;= r) type = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> type = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> type = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">assert</span>(type != <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span>(!type) cout &lt;&lt; <span class="string">&quot;Alice\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;Bob\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div></details>
<h1 id="G"><a href="#G" class="headerlink" title="G"></a>G</h1><p>tag：二分</p>
<details class="toggle" ><summary class="toggle-button" style="">做法</summary><div class="toggle-content"><p>二分答案，然后每个线段能匹配的是一段前驱或者后继，随便贪心的匹配一下就行了。</p>
<p>时间复杂度：$O(n\log{V}\log{n})$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line">LL a[N], b[N], c[N];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">pd</span><span class="params">(LL val)</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; l;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; r;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            LL pos = <span class="built_in">floor</span>((<span class="number">1.0L</span> * val - b[i]) / a[i]);</span><br><span class="line">            <span class="type">int</span> p = <span class="built_in">upper_bound</span>(c + <span class="number">1</span>, c + n + <span class="number">1</span>, pos) - c - <span class="number">1</span>;</span><br><span class="line">            l.<span class="built_in">push_back</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            LL pos = <span class="built_in">ceil</span>((<span class="number">1.0L</span> * val - b[i]) / a[i]);</span><br><span class="line">            <span class="type">int</span> p = <span class="built_in">lower_bound</span>(c + <span class="number">1</span>, c + n + <span class="number">1</span>, pos) - c;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; pos &lt;&lt; &quot; &quot; &lt;&lt; p &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            r.<span class="built_in">push_back</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(b[i] &gt;= val)&#123;</span><br><span class="line">            l.<span class="built_in">push_back</span>(n);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(l.<span class="built_in">begin</span>(), l.<span class="built_in">end</span>());</span><br><span class="line">    <span class="built_in">sort</span>(r.<span class="built_in">begin</span>(), r.<span class="built_in">end</span>());</span><br><span class="line">    <span class="built_in">reverse</span>(r.<span class="built_in">begin</span>(), r.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> cntl = <span class="number">0</span>, cntr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x : l)&#123;</span><br><span class="line">        <span class="keyword">if</span>(cntl &lt; x) cntl++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x : r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n - cntr + <span class="number">1</span> &gt; x) cntr++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cntl + cntr &gt;= (n + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; </span><br><span class="line">    cin.<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> T; cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; b[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; c[i];</span><br><span class="line">        <span class="built_in">sort</span>(c + <span class="number">1</span>, c + n + <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// cout &lt;&lt; pd(114614) &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">        LL l = <span class="number">-2e18</span>, r = <span class="number">2e18</span>, mid, ans = <span class="number">-3e18</span>;</span><br><span class="line">        <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">            mid = l + (r - l) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">pd</span>(mid)) l = mid + <span class="number">1</span>, ans = mid;</span><br><span class="line">            <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div></details>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><details class="toggle" ><summary class="toggle-button" style="">做法</summary><div class="toggle-content"><p>WA 了一发，踩了一点小坑。</p>
<p>可以看到，难点在于无法拿走最后两堆的石头，所以如何将这两堆石头移出来是很关键的问题。</p>
<p>首先注意到一个事情是一个几乎连续的 $1$ 序列可以展开或者收起，即变成 10101… 或者 1111… 。</p>
<p>同时也可以中间的先拿完然后接着收起，即：1111… 变成 1011… 变成 111… 。</p>
<p>所以可以知道第一个结论，如果最后两个位置所在的几乎连续的 1 序列能够将其拉出最后两个位置，就一定可以，即左端点 $\le n-4$ ，同理，如果最后两个位置只有一个 $1$ 就是 $\le n-3$ 。</p>
<p>注意，这里所在的几乎连续的 1 序列是看展开后能不能接到一起，例如下面就是一个 1 序列：1110001 。</p>
<p>然后显然如果最后两个位置有石子且左端点在 $\ge n-2$ 的位置则显然无解。</p>
<p>则关键要讨论最后两堆都有石头且左端点 $=n-3$ 的情况，即：</p>
<p>1011 和 1111 。</p>
<p>1011 ：先操作 1 位置再操作 2 再操作 1，这样局面是 1110 且第 $2$ 堆为偶数，不断操作就可以变成 1010 ，可行。</p>
<p>1111 ：先操作掉第 2 堆石头，所以可行。</p>
<p>所以实际实际上是 $\le n-3$ 就可行。</p>
<p>时间复杂度：$O(n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_char_array</span><span class="params">(<span class="type">char</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> ss[N];</span><br><span class="line">    cin &gt;&gt; ss;</span><br><span class="line">    <span class="built_in">memcpy</span>(s + <span class="number">1</span>, ss, <span class="built_in">sizeof</span>(<span class="type">char</span>) * (<span class="built_in">strlen</span>(ss) + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> st[N];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">work</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">get_char_array</span>(st);</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(st[n] == <span class="string">&#x27;1&#x27;</span>) cnt++;</span><br><span class="line">    <span class="keyword">if</span>(st[n - <span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span>) cnt++;</span><br><span class="line">    <span class="keyword">if</span>(!cnt) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> f = n + <span class="number">1</span>, c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--)&#123;</span><br><span class="line">        c++;</span><br><span class="line">        <span class="keyword">if</span>(st[i] == <span class="string">&#x27;1&#x27;</span>) c -= <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(c &lt;= <span class="number">0</span>) f = i, c = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(f &lt;= n - <span class="number">3</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">work</span>()) cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div></details>
<h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><details class="toggle" ><summary class="toggle-button" style="">做法</summary><div class="toggle-content"><p>这种所有环的题优先关注 DFS 树上只包含一条非树边的环，不妨记这些环为特殊环。</p>
<p>首先所有特殊环的长度一定要一样，其次，可以想到，必要条件是相交的两个特殊环得到的一个环的长度也得一样。</p>
<p>所以可以得到特殊环的交一定得是环长一半，即 $\frac{len}{2}$。</p>
<p>而特殊环在树上只有 $len-1$ 的长度，故如果一个特殊环和两个特殊环有交，可以得到有交部分一定相交，进而可以得到相交部分是同一部分。</p>
<p>进而可以得到充要条件：特殊环等长，相交的特殊环相交于同一部分且相交部分为 $\frac{len}{2}$ 。</p>
<p>实现上，可以发现，如果得到环的相交部分，是通过在 DFS 树上每个点处以合并的方式处理的话，则只需要关心每个环最浅的节点的深度是多少。</p>
<p>所以每个点只需要维护子树到祖先的简单环中每个环最浅节点的深度，而且类似于上面结论的证明可以得到不同的深度不会超过 $2$ 个。</p>
<p>时间复杂度：$O(n)$ 。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; PII;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    <span class="type">int</span> y, next;</span><br><span class="line">&#125;a[N * <span class="number">2</span>]; <span class="type">int</span> cnt, las[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;a[++cnt] = &#123;y, las[x]&#125;; las[x] = cnt;&#125;</span><br><span class="line"><span class="type">int</span> n, m, len;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; pa[N], son[N];</span><br><span class="line"><span class="type">int</span> dep[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">findcir</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = las[x]; k; k = a[k].next)&#123;</span><br><span class="line">        <span class="type">int</span> y = a[k].y;</span><br><span class="line">        <span class="keyword">if</span>(y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span>(!dep[y])&#123;</span><br><span class="line">            dep[y] = dep[x] + <span class="number">1</span>;</span><br><span class="line">            son[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">findcir</span>(y, x)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(dep[y] &lt; dep[x])&#123;</span><br><span class="line">            <span class="type">int</span> tmp = dep[x] - dep[y] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(!len) len = tmp;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(len != tmp) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            pa[x].<span class="built_in">push_back</span>(dep[y]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">itc</span><span class="params">(<span class="type">int</span> dx, <span class="type">int</span> dy, <span class="type">int</span> dt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(len &amp; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">assert</span>(dx &lt; dt &amp;&amp; dy &lt; dt);</span><br><span class="line">    <span class="keyword">return</span> dt - <span class="built_in">max</span>(dx, dy) == len / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> y : son[x])&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">check</span>(y)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> d1 : pa[x])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> d2 : pa[y])&#123;</span><br><span class="line">                <span class="comment">// cerr &lt;&lt; x &lt;&lt; &quot; &quot; &lt;&lt; d1 &lt;&lt; &quot; &quot; &lt;&lt; d2 &lt;&lt; &quot; &quot; &lt;&lt; dep[x] &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">                <span class="keyword">if</span>(!<span class="built_in">itc</span>(d1, d2, dep[x])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> d : pa[y]) pa[x].<span class="built_in">push_back</span>(d);</span><br><span class="line">        <span class="built_in">sort</span>(pa[x].<span class="built_in">begin</span>(), pa[x].<span class="built_in">end</span>());</span><br><span class="line">        pa[x].<span class="built_in">erase</span>(<span class="built_in">unique</span>(pa[x].<span class="built_in">begin</span>(), pa[x].<span class="built_in">end</span>()), pa[x].<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">assert</span>(pa[x].<span class="built_in">size</span>() &lt;= <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!pa[x].<span class="built_in">empty</span>() &amp;&amp; dep[x] == pa[x].<span class="built_in">back</span>() + <span class="number">1</span>) pa[x].<span class="built_in">pop_back</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">work</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="type">int</span> x, y;</span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        <span class="built_in">ins</span>(x, y);</span><br><span class="line">        <span class="built_in">ins</span>(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    dep[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">findcir</span>(<span class="number">1</span>, <span class="number">0</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!len) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">assert</span>(pa[i].<span class="built_in">size</span>() &lt;= <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">check</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        cerr &lt;&lt; i &lt;&lt; <span class="string">&quot; : \n&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> d : pa[i]) cerr &lt;&lt; d &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        cerr &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt = len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        las[i] = dep[i] = <span class="number">0</span>;</span><br><span class="line">        pa[i].<span class="built_in">clear</span>();</span><br><span class="line">        son[i].<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">work</span>()) cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;</span><br><span class="line">        <span class="comment">// print();</span></span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在比赛时得到的结论要多一句：且两个环间相交的部分之间不会产生不相等且相交的关系，但实际上多想一下就知道这句话是多于的，根据 $\frac{len}{2}+\frac{len}{2}&gt;len-1$ 可以知道，如果这个特殊环有两个不同的相交部分，则这两个部分一定相交。会多这一句话是真有点糖了，好久不训练导致的<del>虽然可能以前也这么糖</del>。</p>
</div></details>
<h1 id="J"><a href="#J" class="headerlink" title="J"></a>J</h1><p>tag：扫描线，线段树</p>
<details class="toggle" ><summary class="toggle-button" style="">做法</summary><div class="toggle-content"><p>首先前面部分建树，我用的扫描线，后面部分维护虚树大小，怎么写都行，可以树剖，可以线段树维护虚数形态啥的，但是这里介绍一个维护虚数的技巧。</p>
<p>对于一堆点，其虚树大小（包括链上的点，不止有 LCA） ，可以按照 DFS 序排序，然后相邻两个点的距离和就是虚树大小的两倍 $-2$ ，而这里类似，只不过相邻两个点之间对答案不是简单的和的贡献，可以看成对深度的区间加的操作，用线段树维护一下就行了。</p>
<p>时间复杂度：$O(n\log{n})$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> SN = <span class="number">20</span>;</span><br><span class="line"><span class="type">int</span> n, q, m;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; son[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span>&#123;</span><br><span class="line">    <span class="type">int</span> xl, xr, yl, yr;</span><br><span class="line">&#125;a[N]; <span class="type">int</span> *ls[N * <span class="number">2</span>];</span><br><span class="line"><span class="keyword">namespace</span> Tree&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Query</span>&#123;</span><br><span class="line">        <span class="type">int</span> l, r, pos, type;</span><br><span class="line">    &#125;;</span><br><span class="line">    vector&lt;Query&gt; q;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">        <span class="type">int</span> lc, rc;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; stk;</span><br><span class="line">    &#125;tr[N * <span class="number">4</span>]; <span class="type">int</span> cnt;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">bt</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> x = ++cnt;</span><br><span class="line">        tr[x].stk.<span class="built_in">clear</span>();</span><br><span class="line">        tr[x].lc = tr[x].rc = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(l &lt; r)&#123;</span><br><span class="line">            <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            tr[x].lc = <span class="built_in">bt</span>(l, mid);</span><br><span class="line">            tr[x].rc = <span class="built_in">bt</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ll, <span class="type">int</span> rr, <span class="type">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(rr &lt; l || ll &gt; r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(ll &lt;= l &amp;&amp; r &lt;= rr)&#123;</span><br><span class="line">            <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(!tr[x].stk.<span class="built_in">empty</span>()) ans = tr[x].stk.<span class="built_in">back</span>();</span><br><span class="line">            tr[x].stk.<span class="built_in">push_back</span>(id);</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> al = <span class="built_in">add</span>(tr[x].lc, l, mid, ll, rr, id);</span><br><span class="line">        <span class="type">int</span> ar = <span class="built_in">add</span>(tr[x].rc, mid + <span class="number">1</span>, r, ll, rr, id);</span><br><span class="line">        <span class="built_in">assert</span>(!al || !ar || al == ar);</span><br><span class="line">        <span class="keyword">if</span>(!al &amp;&amp; !ar &amp;&amp; !tr[x].stk.<span class="built_in">empty</span>()) al = tr[x].stk.<span class="built_in">back</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(al, ar);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ll, <span class="type">int</span> rr)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(rr &lt; l || ll &gt; r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(ll &lt;= l &amp;&amp; r &lt;= rr)&#123;</span><br><span class="line">            <span class="built_in">assert</span>(!tr[x].stk.<span class="built_in">empty</span>());</span><br><span class="line">            <span class="type">int</span> ans = tr[x].stk.<span class="built_in">back</span>();</span><br><span class="line">            tr[x].stk.<span class="built_in">pop_back</span>();</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> al = <span class="built_in">del</span>(tr[x].lc, l, mid, ll, rr);</span><br><span class="line">        <span class="type">int</span> ar = <span class="built_in">del</span>(tr[x].rc, mid + <span class="number">1</span>, r, ll, rr);</span><br><span class="line">        <span class="built_in">assert</span>(!al || !ar || al == ar);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(al, ar);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            q.<span class="built_in">push_back</span>(&#123;a[i].yl, a[i].yr, a[i].xl, i&#125;);</span><br><span class="line">            q.<span class="built_in">push_back</span>(&#123;a[i].yl, a[i].yr, a[i].xr, -i&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(q.<span class="built_in">begin</span>(), q.<span class="built_in">end</span>(), [](Query x, Query y)&#123;<span class="keyword">return</span> x.pos &lt; y.pos;&#125;);</span><br><span class="line">        <span class="built_in">bt</span>(<span class="number">1</span>, m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> [l, r, p, t] : q)&#123;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; l &lt;&lt; &quot; &quot; &lt;&lt; r &lt;&lt; &quot; &quot; &lt;&lt; p &lt;&lt; &quot; &quot; &lt;&lt; t &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            <span class="comment">// for(int i = 1; i &lt;= cnt; i++)&#123;</span></span><br><span class="line">            <span class="comment">//     cout &lt;&lt; i &lt;&lt; &quot; :&quot;;</span></span><br><span class="line">            <span class="comment">//     for(auto x : tr[i].stk) cout &lt;&lt; &quot; &quot; &lt;&lt; x;</span></span><br><span class="line">            <span class="comment">//     cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">            <span class="keyword">if</span>(t &gt; <span class="number">0</span>) son[<span class="built_in">add</span>(<span class="number">1</span>, <span class="number">1</span>, m, l, r, t)].<span class="built_in">push_back</span>(t);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">del</span>(<span class="number">1</span>, <span class="number">1</span>, m, l, r);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Segment&#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> x &amp; -x;&#125;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">        LL bst[N];</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">            <span class="keyword">while</span>(x &lt;= n)&#123;</span><br><span class="line">                bst[x] += k;</span><br><span class="line">                x += <span class="built_in">lowbit</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">LL <span class="title">findans</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">            x = <span class="built_in">min</span>(x, n);</span><br><span class="line">            LL ans = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(x)&#123;</span><br><span class="line">                ans += bst[x];</span><br><span class="line">                x -= <span class="built_in">lowbit</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;ti, t1;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">        ti.<span class="built_in">change</span>(x, <span class="number">1ll</span> * x * k);</span><br><span class="line">        t1.<span class="built_in">change</span>(x, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findans</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1ll</span> * (x + <span class="number">1</span>) * t1.<span class="built_in">findans</span>(x) - ti.<span class="built_in">findans</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modif</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    Segment::<span class="built_in">change</span>(l, k);</span><br><span class="line">    Segment::<span class="built_in">change</span>(r + <span class="number">1</span>, -k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dep[N], dfn[N], stk[N], ti;</span><br><span class="line"><span class="type">int</span> fa[N][SN];</span><br><span class="line">set&lt;<span class="type">int</span>&gt; s;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    dfn[x] = ++ti; stk[ti] = x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; SN; i++) fa[x][i] = fa[fa[x][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> y : son[x])&#123;</span><br><span class="line">        dep[y] = dep[x] + <span class="number">1</span>;</span><br><span class="line">        fa[y][<span class="number">0</span>] = x;</span><br><span class="line">        <span class="built_in">dfs</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">findlca</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[x] &gt; dep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = SN - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>((<span class="number">1</span> &lt;&lt; i) &lt;= dep[y] - dep[x]) y = fa[y][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x == y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = SN - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(fa[x][i] != fa[y][i]) x = fa[x][i], y = fa[y][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> state[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modifpath</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> lca = <span class="built_in">findlca</span>(x, y);</span><br><span class="line">    <span class="built_in">modif</span>(dep[lca] + <span class="number">1</span>, dep[x], val);</span><br><span class="line">    <span class="built_in">modif</span>(dep[lca] + <span class="number">1</span>, dep[y], val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        cin &gt;&gt; a[i].xl &gt;&gt; a[i].yl &gt;&gt; a[i].xr &gt;&gt; a[i].yr;</span><br><span class="line">        ls[i * <span class="number">2</span> - <span class="number">1</span>] = &amp;a[i].yl;</span><br><span class="line">        ls[i * <span class="number">2</span>] = &amp;a[i].yr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(ls + <span class="number">1</span>, ls + n * <span class="number">2</span> + <span class="number">1</span>, [](<span class="type">int</span> *x, <span class="type">int</span> *y)&#123;<span class="built_in">return</span> (*x) &lt; (*y);&#125;);</span><br><span class="line">    <span class="type">int</span> pre = (*ls[<span class="number">1</span>]) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n + n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>((*ls[i]) != pre) pre = (*ls[i]), m++;</span><br><span class="line">        (*ls[i]) = m;</span><br><span class="line">    &#125;</span><br><span class="line">    Tree::<span class="built_in">build</span>();</span><br><span class="line">    <span class="comment">// for(int i = 0; i &lt;= n; i++)&#123;</span></span><br><span class="line">    <span class="comment">//     cout &lt;&lt; i &lt;&lt; &quot; : &quot;;</span></span><br><span class="line">    <span class="comment">//     for(auto x : son[i]) cout &lt;&lt; x &lt;&lt; &quot; &quot;;</span></span><br><span class="line">    <span class="comment">//     cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">assert</span>(ti == n + <span class="number">1</span>);</span><br><span class="line">    s.<span class="built_in">insert</span>(<span class="number">1</span>); s.<span class="built_in">insert</span>(n + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; i++)&#123; </span><br><span class="line">        <span class="type">char</span> tmp[<span class="number">10</span>]; <span class="type">int</span> x;</span><br><span class="line">        cin &gt;&gt; tmp &gt;&gt; x;</span><br><span class="line">        <span class="keyword">if</span>(tmp[<span class="number">0</span>] == <span class="string">&#x27;^&#x27;</span>)&#123;</span><br><span class="line">            <span class="type">int</span> prev = stk[*(--s.<span class="built_in">lower_bound</span>(dfn[x]))];</span><br><span class="line">            <span class="type">int</span> nexv = stk[*(s.<span class="built_in">upper_bound</span>(dfn[x]))];</span><br><span class="line">            <span class="type">int</span> val = <span class="number">-1</span>; <span class="keyword">if</span>(state[x]) val = <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">modifpath</span>(prev, nexv, val);</span><br><span class="line">            <span class="built_in">modifpath</span>(prev, x, -val);</span><br><span class="line">            <span class="built_in">modifpath</span>(nexv, x, -val);</span><br><span class="line">            <span class="keyword">if</span>(!state[x]) s.<span class="built_in">insert</span>(dfn[x]);</span><br><span class="line">            <span class="keyword">else</span> s.<span class="built_in">erase</span>(dfn[x]);</span><br><span class="line">            state[x] ^= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> ans = Segment::<span class="built_in">findans</span>(x + <span class="number">1</span>) - Segment::<span class="built_in">findans</span>(x);</span><br><span class="line">            <span class="built_in">assert</span>(ans % <span class="number">2</span> == <span class="number">0</span>);</span><br><span class="line">            cout &lt;&lt; ans / <span class="number">2</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div></details>
<h1 id="F"><a href="#F" class="headerlink" title="F"></a>F</h1><p>tag：NTT</p>
<details class="toggle" ><summary class="toggle-button" style="">做法</summary><div class="toggle-content"><p>就半在线卷积啊，很典的板子。</p>
<p>设 $f[i]$ 表示长度为 $i$ 不能分段的排列有多少个，$g[i]$ 表示长度为 $i$ 的段如果不能分段，就 shuffle ，可以分段就分段的答案（差不多定义，但是有些细节），然后转移就行了，两次半在线。</p>
<p>时间复杂度：$O(n\log^2{n})$ 。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ULL;</span><br><span class="line"><span class="keyword">typedef</span> vector&lt;<span class="type">int</span>&gt; poly;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="function">LL <span class="title">ksm</span><span class="params">(LL x, LL y)</span></span>&#123;</span><br><span class="line">    LL ans = <span class="number">1ll</span>;</span><br><span class="line">    <span class="keyword">while</span>(y)&#123;</span><br><span class="line">        <span class="keyword">if</span>(y &amp; <span class="number">1</span>) ans = ans * x % mod;</span><br><span class="line">        x = x * x % mod;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">poly omega[<span class="number">25</span>]; <span class="comment">// 单位根</span></span><br><span class="line"><span class="comment">// n 是 DFT 的最大长度，例如如果最多有两个长为 m 的多项式相乘，</span></span><br><span class="line"><span class="comment">// 或者求逆的长度为 m，那么 n 需要 &gt;= 2m</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt_init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="comment">// n = 2^k</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">2</span>, d = <span class="number">0</span>; k &lt;= n; k *= <span class="number">2</span>, d++) &#123;</span><br><span class="line">		omega[d].<span class="built_in">resize</span>(k + <span class="number">1</span>);</span><br><span class="line">		<span class="type">int</span> wn = <span class="built_in">ksm</span>(<span class="number">3</span>, (mod - <span class="number">1</span>) / k), tmp = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= k; i++) &#123; omega[d][i] = tmp;</span><br><span class="line">			tmp = (LL)tmp * wn % mod; &#125; &#125; &#125;</span><br><span class="line"><span class="comment">// 传入的数必须是 [0, p) 范围内，不能有负的</span></span><br><span class="line"><span class="comment">// 否则把 d == 16 改成 d % 8 == 0 之类，多取几次模</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> *c, <span class="type">int</span> n, <span class="type">int</span> tp)</span> </span>&#123;</span><br><span class="line">	<span class="type">static</span> ULL a[N];</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) a[i] = c[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">		<span class="type">int</span> k = n; <span class="keyword">do</span> j ^= (k &gt;&gt;= <span class="number">1</span>); <span class="keyword">while</span> (j &lt; k);</span><br><span class="line">		<span class="keyword">if</span> (i &lt; j) <span class="built_in">swap</span>(a[i], a[j]); &#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>, d = <span class="number">0</span>; k &lt; n; k *= <span class="number">2</span>, d++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (d == <span class="number">16</span>) <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) a[i] %= mod;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i += k * <span class="number">2</span>)</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; k; j++) &#123;</span><br><span class="line">				<span class="type">int</span> w = omega[d][tp &gt; <span class="number">0</span> ? j : k * <span class="number">2</span> - j];</span><br><span class="line">				ULL u = a[i + j], v = w * a[i + j + k] % mod;</span><br><span class="line">				a[i + j] = u + v;</span><br><span class="line">				a[i + j + k] = u - v + mod; &#125; &#125;</span><br><span class="line">	<span class="keyword">if</span> (tp&gt;<span class="number">0</span>) &#123;<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) c[i] = a[i] % mod;&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123; <span class="type">int</span> inv = <span class="built_in">ksm</span>(n, mod - <span class="number">2</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) c[i] = a[i] * inv % mod;&#125;&#125;</span><br><span class="line"><span class="function">poly <span class="title">poly_auto_mul</span><span class="params">(poly a, poly b)</span> </span>&#123; <span class="comment">// 自动判断长度的乘法</span></span><br><span class="line">	<span class="type">int</span> res_len = (<span class="type">int</span>)a.<span class="built_in">size</span>() + (<span class="type">int</span>)b.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> ntt_n = <span class="number">1</span>; <span class="keyword">while</span> (ntt_n &lt; res_len) ntt_n *= <span class="number">2</span>;</span><br><span class="line">	a.<span class="built_in">resize</span>(ntt_n); b.<span class="built_in">resize</span>(ntt_n);</span><br><span class="line">	<span class="built_in">ntt</span>(a.<span class="built_in">data</span>(), ntt_n, <span class="number">1</span>); <span class="built_in">ntt</span>(b.<span class="built_in">data</span>(), ntt_n, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ntt_n; i++)</span><br><span class="line">		a[i] = (LL)a[i] * b[i] % mod;</span><br><span class="line">	<span class="built_in">ntt</span>(a.<span class="built_in">data</span>(), ntt_n, <span class="number">-1</span>); a.<span class="built_in">resize</span>(res_len); <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="type">int</span> n; LL g[N], f[N], fc[N], nfc[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solveg</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l == r) <span class="keyword">return</span> ;</span><br><span class="line">	<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">solveg</span>(l, mid);</span><br><span class="line">	&#123;</span><br><span class="line">		poly lg, rg;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = l; i &lt;= mid; i++) lg.<span class="built_in">push_back</span>(g[i]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r - l; i++) rg.<span class="built_in">push_back</span>(fc[i]);</span><br><span class="line">		poly ans = <span class="built_in">poly_auto_mul</span>(lg, rg);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = mid + <span class="number">1</span>; i &lt;= r; i++) g[i] = (g[i] - ans[i - (l + <span class="number">1</span>)] + mod) % mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">solveg</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solvef</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">		<span class="comment">// assert(l != 3);</span></span><br><span class="line">		<span class="comment">// if(l == 3) cout &lt;&lt; f[l] &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">		f[l] = (f[l] + g[l] + g[l - <span class="number">1</span>]) * nfc[l] % mod;</span><br><span class="line">		<span class="built_in">assert</span>((<span class="number">1</span> - g[l] * nfc[l] % mod + mod) % mod != <span class="number">0</span>);</span><br><span class="line">		f[l] = f[l] * <span class="built_in">ksm</span>((<span class="number">1</span> - g[l] * nfc[l] % mod + mod) % mod, mod - <span class="number">2</span>) % mod;</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">solvef</span>(l, mid);</span><br><span class="line">	&#123;</span><br><span class="line">		poly lg, rg;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = l; i &lt;= mid; i++) lg.<span class="built_in">push_back</span>(f[i] * g[i] % mod);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r - l; i++) rg.<span class="built_in">push_back</span>(fc[i]);</span><br><span class="line">		poly ans = <span class="built_in">poly_auto_mul</span>(lg, rg);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = mid + <span class="number">1</span>; i &lt;= r; i++) f[i] = (f[i] + ans[i - (l + <span class="number">1</span>)]) % mod;</span><br><span class="line"></span><br><span class="line">		lg.<span class="built_in">clear</span>(); rg.<span class="built_in">clear</span>(); ans.<span class="built_in">clear</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = l; i &lt;= mid; i++) lg.<span class="built_in">push_back</span>(f[i] * fc[i] % mod);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r - l; i++) rg.<span class="built_in">push_back</span>(g[i]);</span><br><span class="line">		ans = <span class="built_in">poly_auto_mul</span>(lg, rg);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = mid + <span class="number">1</span>; i &lt;= r; i++) f[i] = (f[i] + ans[i - (l + <span class="number">1</span>)]) % mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">solvef</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">ntt_init</span>(<span class="number">1</span> &lt;&lt; <span class="number">20</span>);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">	<span class="keyword">if</span>(n == <span class="number">1</span>)&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;0\n&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	nfc[<span class="number">0</span>] = nfc[<span class="number">1</span>] = fc[<span class="number">0</span>] = fc[<span class="number">1</span>] = <span class="number">1ll</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) nfc[i] = nfc[mod % i] * (mod - mod / i) % mod;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) nfc[i] = nfc[i] * nfc[i - <span class="number">1</span>] % mod, fc[i] = fc[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) g[i] = fc[i];</span><br><span class="line">	<span class="built_in">solveg</span>(<span class="number">1</span>, n);</span><br><span class="line">	<span class="built_in">solvef</span>(<span class="number">2</span>, n);</span><br><span class="line">	<span class="comment">// for(int i = 1; i &lt;= n; i++) cout &lt;&lt; g[i] &lt;&lt; &quot; &quot;;</span></span><br><span class="line">	<span class="comment">// cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">	<span class="comment">// for(int i = 1; i &lt;= n; i++) cout &lt;&lt; f[i] &lt;&lt; &quot; &quot;;</span></span><br><span class="line">	<span class="comment">// cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">	LL ans = <span class="number">0ll</span>; <span class="type">int</span> val = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">		<span class="type">int</span> x;</span><br><span class="line">		cin &gt;&gt; x;</span><br><span class="line">		val = <span class="built_in">max</span>(val, x);</span><br><span class="line">		cnt++;</span><br><span class="line">		<span class="keyword">if</span>(val == i) ans = (ans + f[cnt]) % mod, cnt = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// cout &lt;&lt; val &lt;&lt; &quot; &quot; &lt;&lt; cnt &lt;&lt; &quot; &quot; &lt;&lt; ans &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$f$ 很显然只有一个半在线，$g$ 得到其实有点来头。</p>
<p>我一开始设的 $g_1,g_0$ ，$g_1$ 分段的时候会计入 shuffle 次数，$g_0$ 则是前面计入了，所以分段不会计入 shuffle 次数，但是发现好像转移式里可以把 $g_1$ 中的 $g_0$ 给化掉，所以就不需要 $g_0$ 了。思考组合意义会发现，shuffle 的次数计入是在最后一段计入的，即不能分段的时候再计入，按照这个重写一下转移式就行了，也可以先写出 $g_1,g_0$ 的转移式再化简。不过细节上还是有点区别的，但大体上是这样子。</p>
</div></details>
<h1 id="H"><a href="#H" class="headerlink" title="H"></a>H</h1><p>tag：构造</p>
<details class="toggle" ><summary class="toggle-button" style="">做法</summary><div class="toggle-content"><p>从来没有觉得做构造开心过。</p>
<p>首先显然不需要关心颜色的限制，因为每个点周围不超过 $25$ 个点，直接点染色就行了。</p>
<p>队长在赛时说应该不存在拉满的情况，我证明了一下：</p>
<p><img src="1.png" alt=""></p>
<p>不考虑拉满，只考虑能不能把最后一行填满，可以发现，无论哪种方法，最后一行占用几格，就一定需要占用上面那行同样多格，而两行格数不一样，必然会空出一格。</p>
<p>而显然总格数 $\mod{3}\equiv 1\mathrm{或者}3$，所以一定不可能在拉满的同时让三个底行同时有一个空格，故一定拉不满。</p>
<p>考虑三行三行递归构造，根据 $\mod{2}$ 来讨论，如果最后一行是奇数行，就空出 $1,4$ 格，然后倒数第四行占据 $1,3$ 格，偶数就反过来，在 $n\ge 7$ 时都可以这样递归讨论。</p>
<p>每三行后面的部分用平行四边形填满就行了，然后 $n\le 6$ 随便搞搞就行了。</p>
<p><img src="2.png" alt=""></p>
<p>上面的方案可能和代码中的不太一样，赛时的构造方案没保存就删了，我也懒得去对着代码重新画一遍，手动构造一遍快多了。</p>
<p>时间复杂度：$O(n^2)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1101</span>;</span><br><span class="line"><span class="type">int</span> a[N][N], n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="type">int</span> pn = n;</span><br><span class="line">    <span class="keyword">while</span>(n &gt;= <span class="number">7</span>)&#123;</span><br><span class="line">        <span class="type">int</span> len = n;</span><br><span class="line">        <span class="type">int</span> base = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(n &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            len -= <span class="number">7</span>;</span><br><span class="line">            a[n][<span class="number">2</span>] = a[n][<span class="number">3</span>] = a[n - <span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">            a[n - <span class="number">1</span>][<span class="number">3</span>] = a[n - <span class="number">1</span>][<span class="number">4</span>] = a[n][<span class="number">5</span>] = <span class="number">2</span>;</span><br><span class="line">            a[n - <span class="number">1</span>][<span class="number">5</span>] = a[n][<span class="number">6</span>] = a[n][<span class="number">7</span>] = <span class="number">3</span>;</span><br><span class="line">            a[n - <span class="number">3</span>][<span class="number">1</span>] = a[n - <span class="number">2</span>][<span class="number">1</span>] = a[n - <span class="number">1</span>][<span class="number">2</span>] = <span class="number">4</span>;</span><br><span class="line">            a[n - <span class="number">3</span>][<span class="number">3</span>] = a[n - <span class="number">2</span>][<span class="number">2</span>] = a[n - <span class="number">2</span>][<span class="number">3</span>] = <span class="number">5</span>;</span><br><span class="line">            a[n - <span class="number">2</span>][<span class="number">4</span>] = a[n - <span class="number">2</span>][<span class="number">5</span>] = a[n - <span class="number">1</span>][<span class="number">6</span>] = <span class="number">6</span>;</span><br><span class="line">            base = <span class="number">4</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            len -= <span class="number">8</span>;</span><br><span class="line">            a[n][<span class="number">2</span>] = a[n - <span class="number">1</span>][<span class="number">1</span>] = a[n - <span class="number">2</span>][<span class="number">1</span>] = <span class="number">7</span>;</span><br><span class="line">            a[n - <span class="number">1</span>][<span class="number">2</span>] = a[n - <span class="number">1</span>][<span class="number">3</span>] = a[n][<span class="number">4</span>] = <span class="number">8</span>;</span><br><span class="line">            a[n - <span class="number">1</span>][<span class="number">4</span>] = a[n][<span class="number">5</span>] = a[n][<span class="number">6</span>] = <span class="number">9</span>;</span><br><span class="line">            a[n][<span class="number">7</span>] = a[n][<span class="number">8</span>] = a[n - <span class="number">1</span>][<span class="number">6</span>] = <span class="number">10</span>;</span><br><span class="line">            a[n - <span class="number">1</span>][<span class="number">5</span>] = a[n - <span class="number">2</span>][<span class="number">4</span>] = a[n - <span class="number">3</span>][<span class="number">4</span>] = <span class="number">11</span>;</span><br><span class="line">            a[n - <span class="number">2</span>][<span class="number">2</span>] = a[n - <span class="number">2</span>][<span class="number">3</span>] = a[n - <span class="number">3</span>][<span class="number">1</span>] = <span class="number">12</span>;</span><br><span class="line">            a[n - <span class="number">2</span>][<span class="number">5</span>] = a[n - <span class="number">2</span>][<span class="number">6</span>] = a[n - <span class="number">1</span>][<span class="number">7</span>] = <span class="number">13</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">assert</span>(len % <span class="number">2</span> == <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i += <span class="number">2</span>)&#123;</span><br><span class="line">            a[n][n - i] = a[n][n - i - <span class="number">1</span>] = a[n - <span class="number">1</span>][n - <span class="number">1</span> - i - <span class="number">1</span>] = <span class="number">26</span> - t - base;</span><br><span class="line">            a[n - <span class="number">1</span>][n - <span class="number">1</span> - i] = a[n - <span class="number">2</span>][n - <span class="number">2</span> - i] = a[n - <span class="number">2</span>][n - <span class="number">2</span> - i - <span class="number">1</span>] = <span class="number">26</span> - t - base - <span class="number">1</span>;</span><br><span class="line">            t = (t + <span class="number">2</span>) % <span class="number">4</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        n -= <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">6</span>)&#123;</span><br><span class="line">        a[<span class="number">6</span>][<span class="number">2</span>] = a[<span class="number">5</span>][<span class="number">1</span>] = a[<span class="number">4</span>][<span class="number">1</span>] = <span class="number">14</span>;</span><br><span class="line">        a[<span class="number">6</span>][<span class="number">4</span>] = a[<span class="number">5</span>][<span class="number">2</span>] = a[<span class="number">5</span>][<span class="number">3</span>] = <span class="number">15</span>;</span><br><span class="line">        a[<span class="number">6</span>][<span class="number">5</span>] = a[<span class="number">6</span>][<span class="number">6</span>] = a[<span class="number">5</span>][<span class="number">4</span>] = <span class="number">16</span>;</span><br><span class="line">        a[<span class="number">4</span>][<span class="number">2</span>] = a[<span class="number">3</span>][<span class="number">1</span>] = a[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        a[<span class="number">4</span>][<span class="number">3</span>] = a[<span class="number">4</span>][<span class="number">4</span>] = a[<span class="number">5</span>][<span class="number">5</span>] = <span class="number">2</span>;</span><br><span class="line">        a[<span class="number">1</span>][<span class="number">1</span>] = a[<span class="number">2</span>][<span class="number">2</span>] = a[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">5</span>)&#123;</span><br><span class="line">        a[<span class="number">5</span>][<span class="number">2</span>] = a[<span class="number">5</span>][<span class="number">3</span>] = a[<span class="number">4</span>][<span class="number">1</span>] = <span class="number">14</span>;</span><br><span class="line">        a[<span class="number">5</span>][<span class="number">5</span>] = a[<span class="number">4</span>][<span class="number">3</span>] = a[<span class="number">4</span>][<span class="number">4</span>] = <span class="number">15</span>;</span><br><span class="line">        a[<span class="number">4</span>][<span class="number">2</span>] = a[<span class="number">3</span>][<span class="number">1</span>] = a[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">16</span>;</span><br><span class="line">        a[<span class="number">3</span>][<span class="number">2</span>] = a[<span class="number">2</span>][<span class="number">2</span>] = a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">4</span>)&#123;</span><br><span class="line">        a[<span class="number">4</span>][<span class="number">2</span>] = a[<span class="number">3</span>][<span class="number">1</span>] = a[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">14</span>;</span><br><span class="line">        a[<span class="number">4</span>][<span class="number">4</span>] = a[<span class="number">3</span>][<span class="number">2</span>] = a[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">15</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">3</span>)&#123;</span><br><span class="line">        a[<span class="number">1</span>][<span class="number">1</span>] = a[<span class="number">2</span>][<span class="number">1</span>] = a[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">14</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= pn; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= pn; j++) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= i; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!a[i][j]) cout &lt;&lt; <span class="string">&quot;.&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> cout &lt;&lt; (<span class="type">char</span>)(<span class="string">&#x27;A&#x27;</span> + a[i][j] - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(j &lt; i) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>构造想了挺久的，首先在想存不存在一个不用递归的显示构造，后面发现构造不出来。</p>
<p>遂考虑递归，考虑每次处理最后几行，根据前面的思路可以知道，如果要保证不空出更多的空格，填完最后几行的同时，要把上一行的一些格子也给填上，保证上几行在递归的时候不会空出这些格子出来。</p>
<p>由于显然可以拼出一个面积为 $6$ 的平行四边形，所以一开始想的是两行两行按照 $\mod{3}$ 讨论，但是很快发现不对劲，讨论量很大，而且两行的空间太小。而且要空几格是根据 $n\mod{3}$ 来的，以两行的步长减少 $n$ 很不对劲。而且每两行 $\mod{3}$ 的情况不一样，会出现最后一行需要空的格子数并不统一的情况，相当的麻烦。</p>
<p>所以后面开始三行三行、根据 $\mod{2}$ 讨论，手玩每次最后一行空出一格的情况，大战三百回合不可战胜，由于肯定会空出 $3$ 或者 $4$ 格，所以决定手玩最后一行空出两格的情况，大战三百回合依旧不可战胜。</p>
<p>在过了许久之后写暴力来帮忙找这个循环，发现奇数空 1,4 ，偶数空 1,3 ，可以很好的循环下去，遂做完。</p>
<p>要说怎么精简这个流程，我认为能精简的地方只有我早一点写暴力，这个思路我确实手玩不出来，主要之前我主观上是不太想过度依赖暴力来完成构造的，认为这样不能锻炼思维。</p>
<p>但是这个思路最后用程序跑完后就知道，如果自己手玩来构造这个会浪费大量的时间，而且按照我那种手玩方法，和乱试没什么区别，稍稍有条理一点而已，因此手玩的过程也谈不上什么锻炼思维，只是人工的进行了暴力的过程。所以就释怀了，感觉以后如果可以暴力辅助构造就还是写暴力吧，别把时间浪费在人工模拟暴力上面。</p>
<p>在写博客的时候突然意识到我好像没有用暴力找是否存在空一格的循环，遂尝试了一下，结果发现似乎在 $n\le 11$ 找不到。</p>
<p>下面是暴力的代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; PII;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">20</span>;</span><br><span class="line"><span class="type">int</span> dx[] = &#123;<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125;;</span><br><span class="line">vector&lt;pair&lt;PII, PII&gt;&gt; poss;</span><br><span class="line"><span class="type">bool</span> a[N][N];</span><br><span class="line"><span class="type">int</span> base, i1, i2;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x &lt;= base &amp;&amp; x &gt;= base - <span class="number">3</span> &amp;&amp; y &gt;= <span class="number">1</span> &amp;&amp; y &lt;= x &amp;&amp; a[x][y] == <span class="number">1</span>;&#125;</span><br><span class="line"><span class="comment">// set&lt;pair&lt;PII, PII&gt; &gt; s;</span></span><br><span class="line"><span class="comment">// int g1, g2, g3, g4;</span></span><br><span class="line">set&lt;PII&gt; s;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> dep)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= base - <span class="number">3</span>; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!a[base - <span class="number">3</span>][j])&#123;</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt &gt; <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> tx = <span class="number">0</span>, ty = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = base - <span class="number">2</span>; i &lt;= base; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= i; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i][j])&#123;</span><br><span class="line">                tx = i; ty = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(tx) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!tx)&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; pos;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= base - <span class="number">3</span>; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!a[base - <span class="number">3</span>][j]) pos.<span class="built_in">push_back</span>(j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">assert</span>(pos.<span class="built_in">size</span>() == <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(s.<span class="built_in">find</span>(&#123;i1, pos[<span class="number">0</span>]&#125;) == s.<span class="built_in">end</span>())&#123;</span><br><span class="line">            cout &lt;&lt; i1 &lt;&lt; <span class="string">&quot; - &quot;</span> &lt;&lt; pos[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">            <span class="comment">// if(pos[0] == g3 &amp;&amp; pos[1] == g4)&#123;</span></span><br><span class="line">            <span class="comment">//     for(int i = base - 3; i &lt;= base; i++)&#123;</span></span><br><span class="line">            <span class="comment">//         for(int j = 1; j &lt;= i; j++)&#123;</span></span><br><span class="line">            <span class="comment">//             printf(&quot;%4d&quot;, a[i][j]);</span></span><br><span class="line">            <span class="comment">//         &#125;</span></span><br><span class="line">            <span class="comment">//         printf(&quot;\n&quot;);</span></span><br><span class="line">            <span class="comment">//     &#125;</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">        s.<span class="built_in">insert</span>(&#123;i1, pos[<span class="number">0</span>]&#125;);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> [d1, d2] : poss)&#123;</span><br><span class="line">        <span class="type">int</span> tx1 = d1.first + tx, ty1 = d1.second + ty;</span><br><span class="line">        <span class="type">int</span> tx2 = d2.first + tx, ty2 = d2.second + ty;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">pd</span>(tx1, ty1) &amp;&amp; <span class="built_in">pd</span>(tx2, ty2))&#123;</span><br><span class="line">            a[tx][ty] = a[tx1][ty1] = a[tx2][ty2] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(dep + <span class="number">1</span>);</span><br><span class="line">            a[tx][ty] = a[tx1][ty1] = a[tx2][ty2] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> t = <span class="number">0</span>; t &lt; <span class="number">6</span>; t++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> d = <span class="number">-1</span>; d &lt;= <span class="number">1</span>; d += <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="type">int</span> tt = (t + d + <span class="number">6</span>) % <span class="number">6</span>;</span><br><span class="line">            poss.<span class="built_in">push_back</span>(&#123;&#123;dx[t], dy[t]&#125;, &#123;dx[t] + dx[tt], dy[t] + dy[tt]&#125;&#125;);</span><br><span class="line">            tt = (t + d * <span class="number">2</span> + <span class="number">6</span>) % <span class="number">6</span>;</span><br><span class="line">            <span class="keyword">if</span>(t &lt; tt) poss.<span class="built_in">push_back</span>(&#123;&#123;dx[t], dy[t]&#125;, &#123;dx[tt], dy[tt]&#125;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">    cin &gt;&gt; base;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; base &gt;&gt; g1 &gt;&gt; g2 &gt;&gt; g3 &gt;&gt; g4;</span></span><br><span class="line">    <span class="comment">// i1 = g1; i2 = g2;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = base - <span class="number">3</span>; i &lt;= base; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= i; j++) a[i][j] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// for(i1 = 1; i1 &lt;= base; i1++)&#123;</span></span><br><span class="line">    <span class="comment">//     for(i2 = i1 + 1; i2 &lt;= base; i2++)&#123;</span></span><br><span class="line">    <span class="comment">//         a[base][i1] = a[base][i2] = 0;</span></span><br><span class="line">    <span class="comment">//         dfs(0);</span></span><br><span class="line">    <span class="comment">//         a[base][i1] = a[base][i2] = 1;</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// a[base][g1] = a[base][g2] = 0;</span></span><br><span class="line">    <span class="keyword">for</span>(i1 = <span class="number">1</span>; i1 &lt;= base; i1++)&#123;</span><br><span class="line">        a[base][i1] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">        a[base][i1] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>说起来也是蠢，当时还想用暴力输出方案，但实际上只要知道是空出哪几格后，手动构造方案很快的，没必要浪费那个时间去改代码输出方案。</p>
</div></details></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://oldplace.github.io">player</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://oldplace.github.io/2025/02/09/The-3rd-Ucup-Stage-29-%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/">http://oldplace.github.io/2025/02/09/The-3rd-Ucup-Stage-29-%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://oldplace.github.io" target="_blank">Oldplace</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/my%20avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/my%20avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">player</div><div class="author-info__description">一个蒟蒻在网络上的温馨小窝</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">158</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">70</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/oldplace" target="_blank" title="Github"><i class="fa-brands fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="https://www.luogu.com.cn/user/65602" target="_blank" title="洛谷"><i class="iconfont icon-luogu" style="color: #1461e6;"></i></a><a class="social-icon" href="https://www.codeforces.com/profile/zhangjianjuncd" target="_blank" title="CodeForces"><i class="fa-solid fa-chart-simple" style="color: #fd9d17;"></i></a><a class="social-icon" href="https://atcoder.jp/users/juruozjj" target="_blank" title="AtCoder"><i class="fa-solid fa-a" style="color: #7e0101;"></i></a><a class="social-icon" href="https://loj.ac/u/zhangjianjunab" target="_blank" title="LibreOJ"><i class="fa-solid fa-l" style="color: #9fa4ad;"></i></a><a class="social-icon" href="https://uoj.ac/user/profile/zhangjianjunab" target="_blank" title="Universal Online Judge"><i class="fa-solid fa-u" style="color: #ece509;"></i></a><a class="social-icon" href="https://ac.nowcoder.com/acm/contest/profile/485838814" target="_blank" title="牛客竞赛"><i class="iconfont icon-niu1" style="color: #3c5867;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#C"><span class="toc-number">1.</span> <span class="toc-text">C</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#G"><span class="toc-number">2.</span> <span class="toc-text">G</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#D"><span class="toc-number">3.</span> <span class="toc-text">D</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#E"><span class="toc-number">4.</span> <span class="toc-text">E</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#J"><span class="toc-number">5.</span> <span class="toc-text">J</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#F"><span class="toc-number">6.</span> <span class="toc-text">F</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#H"><span class="toc-number">7.</span> <span class="toc-text">H</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By player</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>function loadUtterances () {
  let ele = document.createElement('script')
  ele.setAttribute('id', 'utterances_comment')
  ele.setAttribute('src', 'https://utteranc.es/client.js')
  ele.setAttribute('repo', 'oldplace/oldplace.github.io')
  ele.setAttribute('issue-term', 'pathname')
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
  ele.setAttribute('theme', nowTheme)
  ele.setAttribute('crossorigin', 'anonymous')
  ele.setAttribute('async', 'true')
  document.getElementById('utterances-wrap').insertAdjacentElement('afterbegin',ele)
}

function utterancesTheme (theme) {
  const iframe = document.querySelector('.utterances-frame')
  if (iframe) {
    const theme = theme === 'dark' ? 'photon-dark' : 'github-light'
    const message = {
      type: 'set-theme',
      theme: theme
    };
    iframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }
}

btf.addModeChange('utterances', utterancesTheme)

if ('Utterances' === 'Utterances' || !true) {
  if (true) btf.loadComment(document.getElementById('utterances-wrap'), loadUtterances)
  else loadUtterances()
} else {
  function loadOtherComment () {
    loadUtterances()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>